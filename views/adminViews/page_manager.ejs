<!DOCTYPE html>
<html lang="zxx" class="js">
  <head>
    <!-- ========Headers meta======== -->
    <%- include('../snippets/adminSnippets/header_meta.ejs') %>

    <title>EXNESTRADE | Pending Investments</title>
  </head>

  <body class="nk-body bg-lighter npc-general has-sidebar">
    <div class="nk-app-root">
      <div class="nk-main">
        <!-- ==========Sidebar======= -->
        <%- include('../snippets/adminSnippets/sidebar.ejs') %>

        <div class="nk-wrap">
          <!-- ============Navbar======== -->
          <%- include('../snippets/adminSnippets/navbar.ejs') %>

          <div class="content-wrapper">
            <div class="container-fluid">
              <div class="row">
                <div class="col-12">
                  <div class="card">
                    <div class="card-header">
                      <h4 class="card-title">Page Content Manager</h4>
                    </div>
                    <div class="card-body">
                      <p class="card-description">
                        Manage all the content displayed on your website's
                        homepage and other pages.
                      </p>

                      <!-- Nav tabs -->
                      <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                          <a
                            class="nav-link active"
                            data-bs-toggle="tab"
                            href="#hero-section"
                            role="tab"
                            >Hero Section</a
                          >
                        </li>
                        <li class="nav-item">
                          <a
                            class="nav-link"
                            data-bs-toggle="tab"
                            href="#about-section"
                            role="tab"
                            >About Section</a
                          >
                        </li>
                        <li class="nav-item">
                          <a
                            class="nav-link"
                            data-bs-toggle="tab"
                            href="#why-choose-us"
                            role="tab"
                            >Why Choose Us</a
                          >
                        </li>
                        <li class="nav-item">
                          <a
                            class="nav-link"
                            data-bs-toggle="tab"
                            href="#testimonials"
                            role="tab"
                            >Testimonials</a
                          >
                        </li>
                        <li class="nav-item">
                          <a
                            class="nav-link"
                            data-bs-toggle="tab"
                            href="#faqs"
                            role="tab"
                            >FAQs</a
                          >
                        </li>
                        <li class="nav-item">
                          <a
                            class="nav-link"
                            data-bs-toggle="tab"
                            href="#crypto-tips"
                            role="tab"
                            >Crypto Tips</a
                          >
                        </li>
                        <li class="nav-item">
                          <a
                            class="nav-link"
                            data-bs-toggle="tab"
                            href="#top-investors"
                            role="tab"
                            >Top Investors</a
                          >
                        </li>
                      </ul>

                      <!-- Tab panes -->
                      <div class="tab-content">
                        <!-- Hero Section Tab -->
                        <div
                          class="tab-pane active"
                          id="hero-section"
                          role="tabpanel"
                        >
                          <div class="row mt-4">
                            <div class="col-md-8">
                              <form id="hero-section-form">
                                <h5>Hero Section Content</h5>
                                <p>
                                  This content appears at the top of your
                                  homepage.
                                </p>
                                <div class="form-group mb-3">
                                  <label for="title">Title</label>
                                  <input
                                    type="text"
                                    class="form-control"
                                    id="title"
                                    name="title"
                                    placeholder="Enter hero title"
                                    value="<%= heroSection.title || '' %>"
                                  />
                                </div>
                                <div class="form-group mb-3">
                                  <label for="subtitle">Subtitle</label>
                                  <textarea
                                    class="form-control"
                                    id="subtitle"
                                    name="subtitle"
                                    rows="5"
                                    placeholder="Enter hero section subtitle"
                                  >
                                    <%= heroSection.subtitle  || '' %></textarea
                                  >
                                </div>

                                <button type="submit" class="btn btn-primary">
                                  Save Changes
                                </button>
                              </form>
                            </div>
                            <div class="col-md-4">
                              <div class="card">
                                <div class="card-body">
                                  <h5 class="card-title">Preview</h5>
                                  <div class="hero-preview mt-3">
                                    <h3 id="hero-title-preview">
                                      <%= heroSection.title || '' %>
                                    </h3>
                                    <p id="hero-subtitle-preview">
                                      <%= heroSection.subtitle || '' %>
                                    </p>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>

                        <!-- About Section Tab -->
                        <div
                          class="tab-pane"
                          id="about-section"
                          role="tabpanel"
                        >
                          <div class="row mt-4">
                            <div class="col-md-8">
                              <form id="about-section-form">
                                <h5>About Section Content</h5>
                                <p>
                                  This content appears in the about section of
                                  your homepage.
                                </p>
                                <div class="form-group mb-3">
                                  <label for="title">Title</label>
                                  <input
                                    type="text"
                                    class="form-control"
                                    id="title"
                                    name="title"
                                    placeholder="Enter about section title"
                                    value="<%= aboutSection.title || '' %>"
                                  />
                                </div>
                                <div class="form-group mb-3">
                                  <label for="description">Description</label>
                                  <textarea
                                    class="form-control rich-editor"
                                    id="description"
                                    name="description"
                                    rows="8"
                                    placeholder="Enter about section description"
                                  >
<%= aboutSection.description || '' %></textarea
                                  >
                                </div>

                                <button type="submit" class="btn btn-primary">
                                  Save Changes
                                </button>
                              </form>
                            </div>
                            <div class="col-md-4">
                              <div class="card">
                                <div class="card-body">
                                  <h5 class="card-title">Preview</h5>
                                  <div class="about-preview mt-3">
                                    <h3 id="about-title-preview">
                                      <%= aboutSection.title || '' %>
                                    </h3>
                                    <div id="about-description-preview">
                                      <%- aboutSection.description || '' %>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>

                        <!-- Why Choose Us Tab -->
                        <div
                          class="tab-pane"
                          id="why-choose-us"
                          role="tabpanel"
                        >
                          <div class="row mt-4">
                            <div class="col-md-6">
                              <h5>Add/Edit Why Choose Us Item</h5>
                              <form id="why-choose-us-form">
                                <div class="form-group mb-3">
                                  <label for="title">Title</label>
                                  <input
                                    type="text"
                                    class="form-control"
                                    id="title"
                                    name="title"
                                    placeholder="Enter title"
                                    required
                                  />
                                </div>
                                <div class="form-group mb-3">
                                  <label for="description">Description</label>
                                  <textarea
                                    class="form-control"
                                    id="description"
                                    name="description"
                                    rows="4"
                                    placeholder="Enter description"
                                    required
                                  ></textarea>
                                </div>
                                <button type="submit" class="btn btn-primary">
                                  Add Why Choose Us Item
                                </button>
                              </form>
                            </div>
                            <div class="col-md-6">
                              <h5>Existing Items</h5>
                              <div id="why-choose-us-container" class="mt-3">
                                <% if (whyChooseUs && whyChooseUs.length > 0) {
                                %> <% whyChooseUs.forEach(function(item) { %>
                                <div class="card mb-3">
                                  <div class="card-body">
                                    <h5 class="card-title">
                                      <%= item.title %>
                                    </h5>
                                    <p class="card-text">
                                      <%= item.description %>
                                    </p>
                                    <p class="card-text">
                                      <small class="text-muted">
                                        Created: <%= new
                                        Date(item.createdAt).toLocaleDateString()
                                        %>
                                      </small>
                                    </p>
                                    <div class="btn-group" role="group">
                                      <button
                                        type="button"
                                        class="btn btn-sm btn-primary edit-btn"
                                        data-id="<%= item._id %>"
                                      >
                                        Edit
                                      </button>
                                      <button
                                        type="button"
                                        class="btn btn-sm btn-danger delete-btn"
                                        data-id="<%= item._id %>"
                                      >
                                        Delete
                                      </button>
                                    </div>
                                  </div>
                                </div>
                                <% }); %> <% } else { %>
                                <div class="alert alert-info">
                                  No Why Choose Us items found. Add your first
                                  item.
                                </div>
                                <% } %>
                              </div>
                            </div>
                          </div>
                        </div>

                        <!-- Testimonials Tab -->
                        <div class="tab-pane" id="testimonials" role="tabpanel">
                          <div class="row mt-4">
                            <div class="col-md-6">
                              <h5>Add/Edit Testimonial</h5>
                              <form id="testimonial-form">
                                <div class="form-group mb-3">
                                  <label for="name">Name</label>
                                  <input
                                    type="text"
                                    class="form-control"
                                    id="name"
                                    name="name"
                                    placeholder="Enter client name"
                                    required
                                  />
                                </div>
                                <div class="form-group mb-3">
                                  <label for="country">Country</label>
                                  <input
                                    type="text"
                                    class="form-control"
                                    id="country"
                                    name="country"
                                    placeholder="Enter client country"
                                    required
                                  />
                                </div>
                                <div class="form-group mb-3">
                                  <label for="message"
                                    >Testimonial Message</label
                                  >
                                  <textarea
                                    class="form-control"
                                    id="message"
                                    name="message"
                                    rows="4"
                                    placeholder="Enter testimonial message"
                                    required
                                  ></textarea>
                                </div>
                                <button type="submit" class="btn btn-primary">
                                  Add Testimonial
                                </button>
                              </form>
                            </div>
                            <div class="col-md-6">
                              <h5>Existing Testimonials</h5>
                              <div id="testimonials-container" class="mt-3">
                                <% if (testimonials && testimonials.length > 0)
                                { %> <%
                                testimonials.forEach(function(testimonial) { %>
                                <div class="card mb-3">
                                  <div class="card-body">
                                    <h5 class="card-title">
                                      <%= testimonial.name %>
                                    </h5>
                                    <h6 class="card-subtitle mb-2 text-muted">
                                      <%= testimonial.country %>
                                    </h6>
                                    <p class="card-text">
                                      <%= testimonial.message %>
                                    </p>
                                    <div class="btn-group" role="group">
                                      <button
                                        type="button"
                                        class="btn btn-sm btn-primary edit-btn"
                                        data-id="<%= testimonial._id %>"
                                      >
                                        Edit
                                      </button>
                                      <button
                                        type="button"
                                        class="btn btn-sm btn-danger delete-btn"
                                        data-id="<%= testimonial._id %>"
                                      >
                                        Delete
                                      </button>
                                    </div>
                                  </div>
                                </div>
                                <% }); %> <% } else { %>
                                <div class="alert alert-info">
                                  No testimonials found. Add your first
                                  testimonial.
                                </div>
                                <% } %>
                              </div>
                            </div>
                          </div>
                        </div>

                        <!-- FAQs Tab -->
                        <div class="tab-pane" id="faqs" role="tabpanel">
                          <div class="row mt-4">
                            <div class="col-md-6">
                              <h5>Add/Edit FAQ</h5>
                              <form id="faq-form">
                                <div class="form-group mb-3">
                                  <label for="question">Question</label>
                                  <input
                                    type="text"
                                    class="form-control"
                                    id="question"
                                    name="question"
                                    placeholder="Enter question"
                                    required
                                  />
                                </div>
                                <div class="form-group mb-3">
                                  <label for="answer">Answer</label>
                                  <textarea
                                    class="form-control"
                                    id="answer"
                                    name="answer"
                                    rows="4"
                                    placeholder="Enter answer"
                                    required
                                  ></textarea>
                                </div>
                                <button type="submit" class="btn btn-primary">
                                  Add FAQ
                                </button>
                              </form>
                            </div>
                            <div class="col-md-6">
                              <h5>Existing FAQs</h5>
                              <div id="faqs-container" class="mt-3">
                                <% if (faqs && faqs.length > 0) { %>
                                <div class="accordion" id="faqsAccordion">
                                  <% faqs.forEach(function(faq, index) { %>
                                  <div class="accordion-item">
                                    <h2
                                      class="accordion-header"
                                      id="heading<%= index %>"
                                    >
                                      <button
                                        class="accordion-button <%= index > 0 ? 'collapsed' : '' %>"
                                        type="button"
                                        data-bs-toggle="collapse"
                                        data-bs-target="#collapse<%= index %>"
                                        aria-expanded="<%= index === 0 %>"
                                        aria-controls="collapse<%= index %>"
                                      >
                                        <%= faq.question %>
                                      </button>
                                    </h2>
                                    <div
                                      id="collapse<%= index %>"
                                      class="accordion-collapse collapse <%= index === 0 ? 'show' : '' %>"
                                      aria-labelledby="heading<%= index %>"
                                      data-bs-parent="#faqsAccordion"
                                    >
                                      <div class="accordion-body">
                                        <p><%= faq.answer %></p>
                                        <div class="btn-group" role="group">
                                          <button
                                            type="button"
                                            class="btn btn-sm btn-primary edit-btn"
                                            data-id="<%= faq._id %>"
                                          >
                                            Edit
                                          </button>
                                          <button
                                            type="button"
                                            class="btn btn-sm btn-danger delete-btn"
                                            data-id="<%= faq._id %>"
                                          >
                                            Delete
                                          </button>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  <% }); %>
                                </div>
                                <% } else { %>
                                <div class="alert alert-info">
                                  No FAQs found. Add your first FAQ.
                                </div>
                                <% } %>
                              </div>
                            </div>
                          </div>
                        </div>

                        <!-- Crypto Tips Tab -->
                        <div class="tab-pane" id="crypto-tips" role="tabpanel">
                          <div class="row mt-4">
                            <div class="col-md-6">
                              <h5>Add/Edit Crypto Tip</h5>
                              <form id="crypto-tip-form">
                                <div class="form-group mb-3">
                                  <label for="title">Title</label>
                                  <input
                                    type="text"
                                    class="form-control"
                                    id="title"
                                    name="title"
                                    placeholder="Enter tip title"
                                    required
                                  />
                                </div>
                                <div class="form-group mb-3">
                                  <label for="content">Content</label>
                                  <textarea
                                    class="form-control"
                                    id="content"
                                    name="content"
                                    rows="4"
                                    placeholder="Enter tip content"
                                    required
                                  ></textarea>
                                </div>
                                <button type="submit" class="btn btn-primary">
                                  Add Crypto Tip
                                </button>
                              </form>
                            </div>
                            <div class="col-md-6">
                              <h5>Existing Crypto Tips</h5>
                              <div id="crypto-tips-container" class="mt-3">
                                <% if (cryptoTips && cryptoTips.length > 0) { %>
                                <% cryptoTips.forEach(function(tip) { %>
                                <div class="card mb-3">
                                  <div class="card-body">
                                    <h5 class="card-title"><%= tip.title %></h5>
                                    <p class="card-text"><%= tip.content %></p>
                                    <p class="card-text">
                                      <small class="text-muted"
                                        >Created: <%= new
                                        Date(tip.createdAt).toLocaleDateString()
                                        %></small
                                      >
                                    </p>
                                    <div class="btn-group" role="group">
                                      <button
                                        type="button"
                                        class="btn btn-sm btn-primary edit-btn"
                                        data-id="<%= tip._id %>"
                                      >
                                        Edit
                                      </button>
                                      <button
                                        type="button"
                                        class="btn btn-sm btn-danger delete-btn"
                                        data-id="<%= tip._id %>"
                                      >
                                        Delete
                                      </button>
                                    </div>
                                  </div>
                                </div>
                                <% }); %> <% } else { %>
                                <div class="alert alert-info">
                                  No crypto tips found. Add your first tip.
                                </div>
                                <% } %>
                              </div>
                            </div>
                          </div>
                        </div>

                        <!-- Top Investors Tab -->
                        <div
                          class="tab-pane"
                          id="top-investors"
                          role="tabpanel"
                        >
                          <div class="row mt-4">
                            <div class="col-md-6">
                              <h5>Add/Edit Top Investor</h5>
                              <form id="top-investor-form">
                                <div class="form-group mb-3">
                                  <label for="name">Investor Name</label>
                                  <input
                                    type="text"
                                    class="form-control"
                                    id="name"
                                    name="name"
                                    placeholder="Enter investor name"
                                    required
                                  />
                                </div>
                                <div class="form-group mb-3">
                                  <label for="amount">Investment Amount</label>
                                  <input
                                    type="number"
                                    class="form-control"
                                    id="amount"
                                    name="amount"
                                    placeholder="Enter investment amount"
                                    step="0.01"
                                    min="0"
                                    required
                                  />
                                </div>
                                <button type="submit" class="btn btn-primary">
                                  Add Top Investor
                                </button>
                              </form>
                            </div>
                            <div class="col-md-6">
                              <h5>Existing Top Investors</h5>
                              <div id="top-investors-container" class="mt-3">
                                <% if (topInvestors && topInvestors.length > 0)
                                { %>
                                <table class="table table-striped">
                                  <thead>
                                    <tr>
                                      <th>Name</th>
                                      <th>Amount</th>
                                      <th>Actions</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <% topInvestors.forEach(function(investor) {
                                    %>
                                    <tr>
                                      <td><%= investor.name %></td>
                                      <td>
                                        $<%= investor.amount.toLocaleString() %>
                                      </td>
                                      <td>
                                        <div class="btn-group" role="group">
                                          <button
                                            type="button"
                                            class="btn btn-sm btn-primary edit-btn"
                                            data-id="<%= investor._id %>"
                                          >
                                            Edit
                                          </button>
                                          <button
                                            type="button"
                                            class="btn btn-sm btn-danger delete-btn"
                                            data-id="<%= investor._id %>"
                                          >
                                            Delete
                                          </button>
                                        </div>
                                      </td>
                                    </tr>
                                    <% }); %>
                                  </tbody>
                                </table>
                                <% } else { %>
                                <div class="alert alert-info">
                                  No top investors found. Add your first top
                                  investor.
                                </div>
                                <% } %>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ========Footer========== -->
          <%- include('../snippets/adminSnippets/footer.ejs') %>
        </div>
      </div>
    </div>

    <!-- ===================Scripts========== -->
    <%- include('../snippets/adminSnippets/scripts.ejs') %>

    <!-- CKEditor - Free Rich Text Editor -->
    <script src="https://cdn.ckeditor.com/ckeditor5/38.1.0/classic/ckeditor.js"></script>

    <!-- Load Page Manager Script -->
    <script src="/apiClient/adminManagePagesClient.js"></script>

    <script>
      // Ensure page manager is initialized after DOM is loaded
      document.addEventListener("DOMContentLoaded", function () {
        console.log("Page Manager DOM content loaded");

        // Initialize CKEditor rich text editor for the description field
        let editor;
        ClassicEditor.create(document.querySelector("#description"))
          .then((newEditor) => {
            editor = newEditor;
            // Make editor instance available globally
            window.descriptionEditor = editor;
            console.log("CKEditor initialized successfully");
          })
          .catch((error) => {
            console.error("Error initializing CKEditor:", error);
          });

        if (window.adminPageManager) {
          window.adminPageManager.init();
        } else {
          console.error("adminPageManager not found");
        }
      });
    </script>
  </body>
</html>
